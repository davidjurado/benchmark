FROM pytorch/pytorch:1.10.0-cuda11.3-cudnn8-runtime

RUN apt-get update -y && apt-get install -y git build-essential ffmpeg libsm6 libxext6 libsndfile1

RUN git clone https://github.com/pytorch/benchmark.git && \
    cd benchmark && \
    python install.py

RUN pip install typer
    
COPY . .

RUN chmod +x ./mlcube/run_test.sh ./mlcube/run_test_bench.sh

ENTRYPOINT ["python", "mlcube/mlcube.py"]
